# PDF to Image Converter - テストプログラム

## 概要
このプログラムは、PDFファイルを画像（PNG/JPEG）に変換するテスト用GUIアプリケーションです。

## 機能
- PDFファイルを画像に変換
- 複数の画像フォーマット対応（PNG、JPEG）
- DPI設定（150、200、300、600）
- ページ範囲指定
- バッチ変換
- 変換結果の表示

## 必要なライブラリ
- `pdf2image` - PDFから画像への変換
- `Pillow` - 画像処理
- `tkinter` - GUI（Python標準ライブラリ）

## インストール方法
```bash
# 仮想環境をアクティベート
.\venv\Scripts\activate

# 必要なライブラリをインストール
pip install pdf2image
```

## 使用方法

### 1. プログラムの起動
```bash
python pdf_to_image_test.py
```

### 2. PDFファイルの選択
- 「ファイルを選択」ボタンをクリック
- 変換したいPDFファイルを選択

### 3. 変換設定
- **画像フォーマット**: PNG または JPEG
- **DPI**: 150、200、300、600 から選択
- **ページ範囲**: 開始ページと終了ページを指定（空白の場合は全ページ）

### 4. 変換実行
- 「変換を開始」ボタンをクリック
- 変換が完了するまで待機

### 5. 結果確認
- 変換結果が表示されます
- 「出力フォルダを開く」で変換された画像ファイルを確認

## 出力ファイル
- 出力フォルダ: `converted_images/`
- ファイル名形式: `{元ファイル名}_page_{ページ番号}_{タイムスタンプ}.{拡張子}`

## テスト用PDFファイルの作成
テスト用のPDFファイルを作成したい場合は、以下のスクリプトを使用できます：

```bash
# reportlabをインストール
pip install reportlab

# テスト用PDFを作成
python create_test_pdf.py
```

## トラブルシューティング

### よくあるエラー

1. **pdf2imageのエラー**
   - Windowsの場合、poppler-utilsのインストールが必要な場合があります
   - エラーメッセージに従って必要な依存関係をインストールしてください

2. **ファイルが見つからない**
   - PDFファイルのパスが正しいことを確認してください
   - ファイルが他のアプリケーションで開かれていないことを確認してください

3. **メモリ不足**
   - 大きなPDFファイルの場合、DPIを下げるかページ範囲を限定してください
   - システムのメモリ使用量を確認してください

## 技術仕様

### 対応フォーマット
- **入力**: PDF
- **出力**: PNG、JPEG

### DPI設定
- 150 DPI: 低解像度、ファイルサイズ小
- 200 DPI: 標準解像度（推奨）
- 300 DPI: 高解像度、印刷品質
- 600 DPI: 最高解像度、ファイルサイズ大

### ファイルサイズの目安
- 200 DPI PNG: 約500KB-2MB/ページ
- 200 DPI JPEG: 約100KB-500KB/ページ

## ライセンス
このプログラムはテスト用に作成されています。商用利用の際は、使用するライブラリのライセンスを確認してください。
