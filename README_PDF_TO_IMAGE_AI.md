# PDF to Image Converter with AI Analysis - テストプログラム

## 概要
このプログラムは、PDFファイルを画像（PNG/JPEG）に変換し、AI（Claude 3.5 Sonnet v2）で画像を分析するテスト用GUIアプリケーションです。

## 機能
- PDFファイルを画像に変換
- 複数の画像フォーマット対応（PNG、JPEG）
- DPI設定（150、200、300、600）
- ページ範囲指定
- バッチ変換
- **AI画像分析機能** - Claude 3.5 Sonnet v2による画像内容分析
- **統合処理** - 変換+AI分析を一度に実行
- 変換結果とAI分析結果の表示（タブ形式）

## 必要なライブラリ
- `pdf2image` - PDFから画像への変換
- `Pillow` - 画像処理
- `tkinter` - GUI（Python標準ライブラリ）
- `boto3` - AWS SDK
- `config` - 設定ファイル（プロジェクト内）

## インストール方法
```bash
# 仮想環境をアクティベート
.\venv\Scripts\activate

# 必要なライブラリをインストール
pip install pdf2image boto3
```

## 使用方法

### 1. プログラムの起動
```bash
python pdf_to_image_ai_analysis.py
```

### 2. PDFファイルの選択
- 「ファイルを選択」ボタンをクリック
- 変換・分析したいPDFファイルを選択

### 3. 変換設定
- **画像フォーマット**: PNG または JPEG
- **DPI**: 150、200、300、600 から選択
- **ページ範囲**: 開始ページと終了ページを指定（空白の場合は全ページ）

### 4. 処理の実行
以下の3つのオプションがあります：

#### A. 画像変換のみ
- 「画像変換を開始」ボタンをクリック
- PDFを画像ファイルに変換

#### B. AI分析のみ
- 「AI分析を開始」ボタンをクリック
- PDFを画像に変換してAIで分析（画像ファイルは保存されない）

#### C. 変換+AI分析（推奨）
- 「変換+AI分析」ボタンをクリック
- PDFを画像に変換して保存し、同時にAIで分析

### 5. 結果確認
- **変換結果タブ**: 生成された画像ファイルの一覧
- **AI分析結果タブ**: 各ページのAI分析結果

## AI分析の内容

AIは以下の観点で画像を分析します：

1. **文書の種類・目的** - 文書の性質と目的の特定
2. **レイアウト・構成** - ページの構成とレイアウトの分析
3. **テキスト内容の概要** - テキストの内容と構造
4. **画像・図表の有無と内容** - 図表や画像の有無と内容
5. **校正すべき点** - 誤字脱字、レイアウト問題、表現の不自然さ
6. **改善提案** - 文書の改善点と提案

## 出力ファイル
- 出力フォルダ: `converted_images/`
- ファイル名形式: `{元ファイル名}_page_{ページ番号}_{タイムスタンプ}.{拡張子}`

## 設定要件

### AWS設定
`config.py` ファイルで以下の設定が必要です：
```python
AWS_DEFAULT_REGION = "us-east-1"  # または適切なリージョン
AWS_ACCESS_KEY_ID = "your-access-key"
AWS_SECRET_ACCESS_KEY = "your-secret-key"
BEDROCK_MODEL_ID = "anthropic.claude-3-5-sonnet-20241022-v2:0"
```

## トラブルシューティング

### よくあるエラー

1. **AWS Bedrock設定エラー**
   - `config.py` の設定を確認してください
   - AWS認証情報が正しいことを確認してください
   - Bedrockモデルへのアクセス権限を確認してください

2. **pdf2imageのエラー**
   - Windowsの場合、poppler-utilsのインストールが必要な場合があります
   - エラーメッセージに従って必要な依存関係をインストールしてください

3. **ファイルが見つからない**
   - PDFファイルのパスが正しいことを確認してください
   - ファイルが他のアプリケーションで開かれていないことを確認してください

4. **メモリ不足**
   - 大きなPDFファイルの場合、DPIを下げるかページ範囲を限定してください
   - システムのメモリ使用量を確認してください

## 技術仕様

### 対応フォーマット
- **入力**: PDF
- **出力**: PNG、JPEG

### DPI設定
- 150 DPI: 低解像度、ファイルサイズ小
- 200 DPI: 標準解像度（推奨）
- 300 DPI: 高解像度、印刷品質
- 600 DPI: 最高解像度、ファイルサイズ大

### AI分析
- **モデル**: Claude 3.5 Sonnet v2
- **最大トークン**: 2000
- **分析内容**: 文書分析、校正提案、改善提案

### ファイルサイズの目安
- 200 DPI PNG: 約500KB-2MB/ページ
- 200 DPI JPEG: 約100KB-500KB/ページ

## 既存プログラムとの違い

### pdf_to_image_test.py（基本版）
- PDFを画像に変換する基本機能
- シンプルなUI
- AI分析機能なし

### pdf_to_image_ai_analysis.py（AI版）
- PDFを画像に変換 + AI分析
- タブ形式の結果表示
- 3つの処理モード（変換のみ、AI分析のみ、統合処理）
- より高度なUI

## ライセンス
このプログラムはテスト用に作成されています。商用利用の際は、使用するライブラリのライセンスを確認してください。
